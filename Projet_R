# ui.R
library(shiny)
library(DT)
library(leaflet)
library(ggplot2)

# Interface utilisateur avec des onglets
ui <- fluidPage(
  
  titlePanel("Sportifs de Haut niveau en 2015"),
  
  tabsetPanel(
    tabPanel("Recherche", 
             mainPanel(
               textOutput("summary"), 
               DTOutput("contents")    
             )
    ),
    
    tabPanel("Cartes",
             # Utilisation de sidebarLayout pour une colonne de sélection à gauche
             sidebarLayout(
               sidebarPanel(
                 h4("Options de sélection"),
                 selectInput("variable", "Choisir une variable :",
                             choices = c("Option 1", "Option 2", "Option 3")),
                 selectInput("fednom", "Choisir une Fédération : ",
                             choices = c("Option 1", "Option 2", "Option 3")),
                 selectInput("discipline", "Choisir une Discipline : ",
                             choices = c("Option 1", "Option 2", "Option 3")),
                 selectInput("annee", "Choisir une Plage d'année : ",
                             choices = c("Option 1", "Option 2", "Option 3")),
                 actionButton("update", "Mettre à jour")
               ),
               mainPanel(
                 tabsetPanel(
                   tabPanel("Proportion",
                            leafletOutput("france_map_proportion", height = 500)
                   ),
                   tabPanel("Chiffres",
                            leafletOutput("france_map_chiffres", height = 500)
                   )
                 )
               )
             )
    ),
    
    tabPanel("Statistiques", 
             mainPanel(
               h3("Graphiques et statistiques"),
               plotOutput("stats") 
             )
    )
  )
)

# server.R
library(shiny)
library(openxlsx)
library(DT)
library(leaflet)
library(ggplot2)

server <- function(input, output) {
  
  file_path <- "SHN_2015_projet.xlsx"  # Chemin relatif ou ajout de fonction pour upload
  
  data <- read.xlsx(file_path, sheet = 1)  
  
  output$contents <- renderDT({
    datatable(data, options = list(pageLength = 10))
  })
  
  # Carte pour l'onglet Proportion
  output$france_map_proportion <- renderLeaflet({
    leaflet() %>%
      addTiles() %>%
      setView(lng = 2.3522, lat = 48.8566, zoom = 5)
  })
  
  # Carte pour l'onglet Chiffres
  output$france_map_chiffres <- renderLeaflet({
    leaflet() %>%
      addTiles() %>%
      setView(lng = 2.3522, lat = 48.8566, zoom = 5)
  })
  
  output$stats <- renderPlot({
    ggplot(data, aes(x = Sexe, y = Club)) + 
      geom_point() + 
      theme_minimal()
  })
}
